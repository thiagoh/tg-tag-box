/*! tg-tag-box - v0.1.0 - 2015-11-08
* https://github.com/thiago/tg-tag-box
* Copyright (c) 2015 Thiago Andrade; Licensed MIT */
!function(a,b){"use strict";a.module("tgTagBoxModule",[]).directive("tgTagBox",["$http","$q","$log",function(c,d,e){var f=function(c,e,f,g){var h=e.find("input"),i=b(e[0]).find(".chosen-wrapper"),j=b(e[0]).find(".fake-input"),k=function(a,b){var c,d=0,e=a.length;if(b.id){for(;e>d;d++)if(b.id===a[d].id)return d;return-1}return c=a.indexOf(b)},l=function(b){var c;return c="object"==typeof b?a.extend({},b):{label:b,id:b,value:b}},m=function(){var a,c,d,e;a=j.width(),c=i.width(),d=b("#idSpan").html(h.val()).width()+1,b(h[0]).width(d),"relative"!==i.css("position")&&(i.css("position","relative"),b(h[0]).css("position","relative")),c+d>a?(e=-1*(c+d-a),i.css("left",e+"px"),b(h[0]).css("left",e+"px")):(i.css("left","0px"),b(h[0]).css("left","0px"))},n=function(){b('<span id="idSpan" style="position: absolute; left: -100000px;"></span>').appendTo(document.body),c.results=[],c.output=[],h.val(""),c.userOutput&&(c.output=c.userOutput,[].push.apply(c.results,c.userOutput.map(l))),c.userSearch&&(c.search=c.userSearch)};c.focus=function(){h[0].focus()},c.removeItem=function(a,b){var d=k(c.results,b);a.preventDefault(),a.stopPropagation(),d>=0&&(c.results.splice(d,1),c.output.splice(d,1))},c.addItem=function(a,b){a.preventDefault(),a.stopPropagation(),-1===k(c.results,b)&&(c.results.push(b),c.output.push(b.value),h.val(""),c.keyup(),c.focus())},c.keyup=function(a){var b=d.defer(),e=b.promise;return m(),c.searchData=[],""!==h.val().trim()?(e.then(function(){return c.search(h.val())}).then(function(a){return a.length?(c.searchData=a.map(l),void m()):void b.reject(a)})["catch"](function(a){b.reject(a),c.searchData=[],m()}),b.resolve(),b.promise):void 0},n()},g='<div class="tg-tag-box outer">   <div class="fake-input" ng-click="focus($event)">       <span class="chosen-wrapper"><span class="chose" ng-repeat="entry in results"            >{{entry.label}}<span class="delete" ng-click="removeItem($event, entry)">x</span></span></span>       <input type="text" class="query" ng-keyup="keyup($event)" />   </div>   <div class="inner" ng-show="searchData.length > 0">       <span class="item" ng-click="addItem($event, entry)" ng-repeat="entry in searchData">           {{entry.label}}      </span>   </div></div>';return{restrict:"AE",template:g,scope:{userOutput:"=ngModel",userSearch:"=search"},link:function(a,b,c,d){return f(a,b,c,d)}}}])}("undefined"!=typeof angular&&angular||{},jQuery);